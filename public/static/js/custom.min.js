function lightbox(){$("#galley").lightGallery({selector:".links",thumbnail:!1,hash:!1,download:!1}),$(".main-image").lightGallery({selector:".image",thumbnail:!1,hash:!1,download:!1})}function colorChange(){var t=$(".mainImage"),e=new Image;e.onload=function(){for(var t=new ColorThief,a=t.getPalette(e,6),o=0;o<a.length;o++)$(".colorPalettes").append('<div class="colorPalette" style="background-color:rgb('+a[o][0]+","+a[o][1]+","+a[o][2]+')"></div>')},e.crossOrigin="Anonymous",e.src=t.attr("src")}function reply(){var t=$(".replybutton"),e=$(".closebutton"),a=$(".replytext");t.on("click",function(){var t=$(this).attr("id");$(this).hide(),$("#open"+t).show(),a.focus()}),e.on("click",function(){var e=$(this).attr("id");$("#open"+e).hide(),t.show()}),$(".replyMainButton").click(function(){var t=$(this).attr("id"),e=$("#textboxcontent"+t).val(),o="textcontent="+e+"&reply_msgid="+t;return""===e?a.stop().css("background-color","#FFFF9C"):$.ajax({type:"POST",url:"../../reply",data:o,success:function(e){var a=[{tag:"hr",html:""},{tag:"div","class":"media",children:[{tag:"a","class":"pull-left",href:"${profile_link}",children:[{tag:"img","class":"media-object img-circle",src:"${profile_avatar}",alt:"${fullname}",html:""}]},{tag:"div","class":"media-body",children:[{tag:"h4","class":"media-heading",children:[{tag:"a",href:"${profile_link}",html:"${fullname}"},{tag:"span","class":"pull-right",children:[{tag:"i","class":"comment-time fa fa-clock-o fa-fw",html:""},{tag:"abbr","class":"timeago comment-time",title:"${time}",html:"${time}"}]}]},{tag:"p",html:"${reply}"}]}]}],o=[e];$(".reply-add-"+t).json2html(o,a),$("#openbox-"+t).hide(300)}}),!1})}function voteComment(){$(".vote-comment").on("click",function(){var t=$(this),e=t.attr("data-id"),a="id="+e,o=$("#data-comment-"+e);return $.ajax({type:"POST",url:"../../votecomment",data:a,success:function(e){$.when(t.fadeOut()).done(function(){t.hasClass("comment-voted")?t.removeClass("comment-voted"):t.removeClass("vote-comment").addClass("comment-voted"),t.fadeIn(),o.text(e)})}}),!1})}function voteReply(){$(".vote-reply").on("click",function(){var t=$(this),e=t.attr("data-id"),a="id="+e,o=$("#data-reply-"+e);return $.ajax({type:"POST",url:"../../votereply",data:a,success:function(e){$.when(t.fadeOut()).done(function(){t.hasClass("comment-voted")?t.removeClass("comment-voted"):t.removeClass("vote-comment").addClass("comment-voted"),t.fadeIn(),o.text(e)})}}),!1})}function followUnFollow(){$(".follow").on("click",function(){var t=$(this),e="id="+t.attr("id");return $.ajax({type:"POST",url:"../../follow",data:e,success:function(e){$.when(t.fadeOut(300).promise()).done(function(){t.hasClass("btn")?t.removeClass("btn-default").addClass("btn-success").text(e).fadeIn():t.replaceWith('<span class="notice_mid_link">'+e+"</span>")})}}),!1})}function deleteComment(){var t=$("button.delete-comment");t.on("click",function(){var t=$(this),e=t.attr("data-content"),a="id="+e;$.ajax({type:"POST",url:"../../deletecomment",data:a,success:function(t){$("#comment-"+e).hide(500)}})})}function deleteReply(){var t=$("button.delete-reply");t.on("click",function(){var t=$(this),e=t.attr("data-content"),a="id="+e;$.ajax({type:"POST",url:"../../deletereply",data:a,success:function(t){$("#reply-"+e).hide(500)}})})}function favorite(){$(".favoritebtn").on("click",function(){var t=$(this),e="id="+t.attr("id");return $.ajax({type:"POST",url:"../../favorite",data:e,success:function(e){$.when(t.fadeOut(300).promise()).done(function(){t.hasClass("btn")?t.removeClass("btn-default").addClass("btn-success").text(e).fadeIn():t.replaceWith('<span class="notice_mid_link">'+e+"</span>")})}}),!1})}function keyboardNavigation(){$(document).keydown(function(t){37==t.keyCode?$("div.controlArrow a.fa-chevron-left:first-child").attr("href")&&(window.location=$("div.controlArrow a.fa-chevron-left:first-child").attr("href")):39==t.keyCode&&$("div.controlArrow a.fa-chevron-right:first-child").attr("href")&&(window.location=$("div.controlArrow a.fa-chevron-right:first-child").attr("href"))})}function run_pinmarklet(){var t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("charset","UTF-8"),t.setAttribute("src","http://assets.pinterest.com/js/pinmarklet.js?r="+99999999*Math.random()),document.body.appendChild(t)}$(function(){favorite();var t=$("img.display-image");t.lazyload({threshold:200}),lightbox(),deleteComment(),followUnFollow(),deleteReply(),reply(),voteComment(),voteReply(),keyboardNavigation(),autosize(document.querySelectorAll("textarea"));var e=$("abbr.timeago");e.timeago(),$("div.flash_message").not(".flash_important").delay(2e3).slideUp(),$(".mainImage").length&&colorChange(),$("[data-toggle='tooltip']").tooltip(),$("#dp1").datepicker({format:"yyyy-mm-dd"})});